<div class="page-std-padding-x page-std-padding-y space-y-8 bg-gray-50 min-h-screen">
    <h1 class="text-3xl font-bold text-gray-900 mb-6 text-center">User Profile</h1>

    <div class="flex flex-col items-center mb-8">
        <div class="w-24 h-24 rounded-full bg-blue-100 flex items-center justify-center text-blue-800 text-5xl font-bold border-2 border-blue-400">
            <ng-container *ngIf="currentUser?.displayName; else defaultAvatar">
                {{ currentUser?.displayName?.charAt(0)?.toUpperCase() }}
            </ng-container>
            <ng-template #defaultAvatar>
                <svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16 text-blue-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                </svg>
            </ng-template>
        </div>
        <h2 class="mt-4 text-2xl font-semibold text-gray-900">
            {{ currentUser?.displayName ?? 'New User' }}
        </h2>
        <p class="text-sm text-gray-500">
            {{ currentUser?.email }} </p>
    </div>

    <div class="max-w-xl mx-auto bg-white p-6 rounded-lg shadow-md space-y-4">
        <h3 class="text-xl font-semibold text-gray-800 border-b pb-3 mb-4">Personal Information</h3>

        <div class="flex items-center space-x-2 text-lg">
            <div class="font-semibold w-36 flex-shrink-0 text-gray-700">
                Display Name:
            </div>
            <div class="text-gray-800 flex-grow">
                {{ currentUser?.displayName ?? '-' }}
            </div>
        </div>

        <div class="flex items-center space-x-2 text-lg">
            <div class="font-semibold w-36 flex-shrink-0 text-gray-700">
                Email:
            </div>
            <div class="text-gray-800 flex-grow">
                {{ currentUser?.email ?? '-' }}
            </div>
        </div>
    </div>

    <div class="max-w-xl mx-auto bg-white p-6 rounded-lg shadow-md space-y-4 mt-6">
        <h3 class="text-xl font-semibold text-gray-800 border-b pb-3 mb-4">Account Activity</h3>

        <div class="flex items-center space-x-2 text-lg">
            <div class="font-semibold w-36 flex-shrink-0 text-gray-700">
                Joined At:
            </div>
            <div class="text-gray-800 flex-grow">
                <ng-container *ngIf="currentUser?.createdAt; else noCreatedAt">
                    {{ currentUser?.createdAt | date:'medium' }}
                </ng-container>
                <ng-template #noCreatedAt>-</ng-template>
            </div>
        </div>

        <div class="flex items-center space-x-2 text-lg">
            <div class="font-semibold w-36 flex-shrink-0 text-gray-700">
                Last updated:
            </div>
            <div class="text-gray-800 flex-grow">
                <ng-container *ngIf="currentUser?.updatedAt; else noUpdatedAt">
                    {{ currentUser?.updatedAt | date:'medium' }}
                </ng-container>
                <ng-template #noUpdatedAt>-</ng-template>
            </div>
        </div>
    </div>

    <div class="max-w-6xl mx-auto bg-white p-6 rounded-lg shadow-md mt-6">
        <h3 class="text-xl font-semibold text-gray-800 border-b pb-3 mb-4">Watching Activity</h3>
        <div class="flex flex-col xl:flex-row justify-start items-start">
            <div class="heatmap-main-content flex p-2 border border-gray-200 rounded-md overflow-x-auto flex-grow min-w-0 w-full">
                <div class="flex flex-col justify-start mr-2 text-xs text-gray-500 pt-5 flex-shrink-0">
                    <div class="h-[13px] leading-none"></div> 
                    <div class="h-[13px] leading-none mb-1">Mon</div>
                    <div class="h-[13px] leading-none"></div>
                    <div class="h-[13px] leading-none mb-1">Wed</div>
                    <div class="h-[13px] leading-none"></div>
                    <div class="h-[13px] leading-none mb-1">Fri</div>
                    <div class="h-[13px] leading-none"></div>
                </div>

                <!-- Heatmap -->
                <div class="flex flex-col">
                    <div class="flex mb-2 flex-nowrap space-x-9">
                        <ng-container *ngFor="let month of months; let i = index">
                            <div class="text-xs text-gray-500 text-left" [style.min-width.px]="i === months.length - 1 ? 0 : 40">{{ month }}</div>
                        </ng-container>
                    </div>

                    <div class="flex flex-nowrap">
                        <ng-container *ngFor="let week of calendarDays; let i = index">
                            <div class="flex flex-col space-y-1 mr-1 flex-shrink-0">
                                <ng-container *ngFor="let day of week">
                                    <div
                                        *ngIf="day.count !== -1"
                                        [class]="'w-[13px] h-[13px] rounded-sm ' + getHeatmapColor(day.count)"
                                        [title]="day.count + ' movies on ' + (day.date | date:'mediumDate')"
                                    ></div>
                                    <div
                                        *ngIf="day.count === -1"
                                        class="w-[13px] h-[13px] rounded-sm bg-transparent"
                                    ></div>
                                </ng-container>
                            </div>
                        </ng-container>
                    </div>
                </div>
            </div>
            
            <div class="ml-0 xl:ml-6 mt-4 xl:mt-0 flex flex-row xl:flex-col justify-center xl:justify-start items-center xl:items-start space-x-4 xl:space-x-0 xl:space-y-2 w-full xl:w-auto font-semibold">
                <button
                    *ngFor="let year of availableYears"
                    (click)="changeHeatmapYear(year)"
                    [ngClass]="{
                        'font-bold text-blue-700 bg-blue-100 shadow-md ring-2 ring-blue-400': year === currentHeatmapYear,
                        'text-gray-700 hover:bg-gray-200 active:bg-gray-300 hover:shadow-sm': year !== currentHeatmapYear
                    }"
                    class="px-3 py-1 rounded-md transition-all duration-200 ease-in-out text-sm whitespace-nowrap flex-shrink-0 cursor-pointer"
                >
                    {{ year }}
                </button>
            </div>
        </div>

        <div class="flex justify-end items-center mt-2 text-xs text-gray-500">
            Less
            <div class="w-[13px] h-[13px] rounded-sm bg-gray-200 ml-1 mr-0.5"></div>
            <div class="w-[13px] h-[13px] rounded-sm bg-green-100 mr-0.5"></div>
            <div class="w-[13px] h-[13px] rounded-sm bg-green-300 mr-0.5"></div>
            <div class="w-[13px] h-[13px] rounded-sm bg-green-500 mr-0.5"></div>
            <div class="w-[13px] h-[13px] rounded-sm bg-green-700 mr-1"></div>
            More
        </div>
    </div>

    <div class="flex justify-center space-x-4 mt-8">
        <a [routerLink]="'/edit-profile'" class="standard-write-button">
            Edit Profile
        </a>
        <button class="standard-action-button">
            Change Password
        </button>
    </div>
</div>