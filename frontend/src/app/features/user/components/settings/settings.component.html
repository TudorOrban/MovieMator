<div class="w-full page-std-padding-y">
    <div class="page-std-padding-x std-border-b">
        <div class="flex items-center justify-between mb-6">
            <h2 class="text-2xl font-bold">Settings</h2>
        </div>

        <div class="text-blue-700 mb-6">
            Logged in as: {{ currentUser?.displayName ?? "User: -" }}
        </div>
    </div>
    
    <div *ngIf="isLoading" class="text-center py-8 text-gray-600">
        Loading settings...
    </div>

    <form 
        [formGroup]="settingsForm" 
        (ngSubmit)="onSubmit()" 
        *ngIf="!isLoading" 
        class="page-std-padding-x py-4"
    >
        <div class="space-y-2 mb-6">
            <label for="appTheme" class="form-label">Application Theme</label>
            <select
                id="appTheme"
                formControlName="appTheme"
                class="form-select"
            >
                <option *ngFor="let option of appThemeOptions" [value]="option.value">{{ option.label }}</option>
            </select>
            <div *ngIf="settingsForm.get('appTheme')?.invalid && settingsForm.get('appTheme')?.touched" class="form-error">
                Theme is required.
            </div>
        </div>

        <!-- <div class="flex items-center space-x-2 mb-6">
            <input
                type="checkbox"
                id="confirmDeletions"
                formControlName="confirmDeletions"
                class="form-checkbox"
            >
            <label for="confirmDeletions" class="form-label mb-0">Confirm before deleting movies/reviews</label>
        </div> -->

        <div class="space-y-2 mb-6">
            <label for="defaultMovieSortBy" class="form-label">Default Movie List Sort Order</label>
            <select
                id="defaultMovieSortBy"
                formControlName="defaultMovieSortBy"
                class="form-select"
            >
                <option *ngFor="let option of sortByOptions" [value]="option.value">{{ option.label }}</option>
            </select>
            <div *ngIf="settingsForm.get('defaultMovieSortBy')?.invalid && settingsForm.get('defaultMovieSortBy')?.touched" class="form-error">
                Default sort order is required.
            </div>
        </div>

        <div class="space-y-2 mb-6">
            <label for="moviesPerRow" class="form-label">Movies Displayed Per Row (Grid View)</label>
            <select
                id="moviesPerRow"
                formControlName="moviesPerRow"
                class="form-select"
            >
                <option *ngFor="let option of moviesPerRowOptions" [value]="option.value">{{ option.label }}</option>
            </select>
            <div *ngIf="settingsForm.get('moviesPerRow')?.invalid && settingsForm.get('moviesPerRow')?.touched" class="form-error">
                Movies per row is required and must be a positive number.
            </div>
        </div>

        <!-- <div class="space-y-2 mb-6">
            <label for="defaultStatsTimePeriod" class="form-label">Default Statistics Time Period</label>
            <select
                id="defaultStatsTimePeriod"
                formControlName="defaultStatsTimePeriod"
                class="form-select"
            >
                <option *ngFor="let option of statsTimePeriodOptions" [value]="option.value">{{ option.label }}</option>
            </select>
            <div *ngIf="settingsForm.get('defaultStatsTimePeriod')?.invalid && settingsForm.get('defaultStatsTimePeriod')?.touched" class="form-error">
                Default stats time period is required.
            </div>
        </div> -->

        <div class="space-y-2 mb-6">
            <label for="defaultRankingSortBy" class="form-label">Default Ranking List Sort Order</label>
            <select
                id="defaultRankingSortBy"
                formControlName="defaultRankingSortBy"
                class="form-select"
            >
                <option *ngFor="let option of sortByOptions" [value]="option.value">{{ option.label }}</option>
            </select>
            <div *ngIf="settingsForm.get('defaultRankingSortBy')?.invalid && settingsForm.get('defaultRankingSortBy')?.touched" class="form-error">
                Default sort order is required.
            </div>
        </div>

        <div class="space-y-2 mb-6">
            <label for="rankingsPerRow" class="form-label">Rankings Displayed Per Row (Grid View)</label>
            <select
                id="rankingsPerRow"
                formControlName="rankingsPerRow"
                class="form-select"
            >
                <option *ngFor="let option of rankingsPerRowOptions" [value]="option.value">{{ option.label }}</option>
            </select>
            <div *ngIf="settingsForm.get('rankingsPerRow')?.invalid && settingsForm.get('rankingsPerRow')?.touched" class="form-error">
                Rankings per row is required and must be a positive number.
            </div>
        </div>

        <div class="flex justify-end space-x-4 mt-8">
            <button
                type="button"
                class="standard-action-button text-gray-600 hover:text-gray-800"
                (click)="onCancel()"
                [disabled]="isSaving || !hasChanges()"
            >
                <fa-icon [icon]="faTimes" class="mr-2"></fa-icon> Cancel
            </button>
            <button
                type="submit"
                class="standard-write-button"
                [disabled]="settingsForm.invalid || isSaving"
            >
                <fa-icon [icon]="faSave" class="mr-2"></fa-icon> {{ isSaving ? 'Saving...' : 'Save Changes' }}
            </button>
        </div>
    </form>
</div>